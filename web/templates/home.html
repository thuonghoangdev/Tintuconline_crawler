{% extends "base.html" %}
{% block title %}Tin T·ª©c Online ‚Äî Trang ch·ªß{% endblock %}

{% block extra_head %}
<style>
/* HERO + SIDEBAR (ch·ªâ d√πng ·ªü home) */
.home-hero{display:grid;grid-template-columns:3fr 1.2fr;gap:24px;margin-bottom:20px}
.hero-card{position:relative;overflow:hidden;border-radius:16px;background:#0b0f15;box-shadow:0 10px 30px rgba(2,6,23,.12);min-height:360px}
.hero-card img{width:100%;height:100%;object-fit:cover;display:block;filter:brightness(.92)}
.hero-overlay{position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,0) 0%,rgba(0,0,0,.65) 75%);z-index:1}
.hero-content{position:absolute;left:20px;right:20px;bottom:18px;z-index:2;color:#fff}
.hero-badge{display:inline-block;background:#2563eb;color:#fff;font-weight:800;font-size:12px;padding:6px 10px;border-radius:999px;margin-bottom:12px}
.hero-title{font-size:30px;line-height:1.25;font-weight:900;margin:0 0 8px}
.hero-excerpt{color:#e5e7eb;margin:6px 0 10px}
.hero-meta{font-size:13px;color:#cbd5e1;display:flex;gap:14px}

/* Trending box */
.trend-box{background:#fff;border:1px solid var(--border);border-radius:16px;padding:16px;box-shadow:var(--shadow)}
.trend-title{font-weight:900;margin:0 0 10px;display:flex;align-items:center;gap:6px;color:#1e3a8a}
.trend-title::before{content:"üî•"}
.trend-list{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:12px}
.trend-item{display:grid;grid-template-columns:24px 92px 1fr;gap:10px;align-items:center}
.trend-item .rank{text-align:right;color:#2563eb;font-weight:900}
.trend-item .thumb img{width:92px;height:68px;object-fit:cover;border-radius:10px;background:#f1f5f9;display:block}
.trend-item .info a{font-weight:800;color:#0f172a;display:block;line-height:1.35}
.trend-item .info a:hover{color:#2563eb}
.trend-item .meta{font-size:12.5px;color:#6b7280;margin-top:2px}

/* Responsive */
@media(max-width:980px){.home-hero{grid-template-columns:1fr}}
</style>
{% endblock %}

{% block content %}

{# ===== HERO + TIN XU H∆Ø·ªöNG (sidebar ch·ªâ ·ªü home) ===== #}
<section class="home-hero">
  <!-- HERO -->
  <div class="hero-card">
    {% if hero %}
      <img src="{{ hero.main_image_url }}"
           alt="{{ hero.title }}"
           referrerpolicy="no-referrer"
           onerror="this.onerror=null;this.src='https://picsum.photos/1200/600?blur=1';">
      <div class="hero-overlay"></div>
      <div class="hero-content">
        <span class="hero-badge">N·ªïi b·∫≠t</span>
        <h2 class="hero-title"><a href="{% url 'article_detail' slug=hero.slug %}" style="color:#fff">{{ hero.title }}</a></h2>
        {% if hero.excerpt %}<p class="hero-excerpt">{{ hero.excerpt }}</p>{% endif %}
        <div class="hero-meta">
          {% if hero.published_at %}<span>{{ hero.published_at|date:"d/m/Y" }}</span>{% endif %}
          {% with first=hero.categories.first %}{% if first %}<span>{{ first.name }}</span>{% endif %}{% endwith %}
        </div>
      </div>
    {% else %}
      <img src="https://picsum.photos/1200/600?grayscale&blur=1" alt="">
      <div class="hero-overlay"></div>
      <div class="hero-content">
        <span class="hero-badge">N·ªïi b·∫≠t</span>
        <h2 class="hero-title">B√†i vi·∫øt n·ªïi b·∫≠t</h2>
        <p class="hero-excerpt">Ch∆∞a ch·ªçn ƒë∆∞·ª£c b√†i n·ªïi b·∫≠t ‚Äî h·ªá th·ªëng s·∫Ω t·ª± ch·ªçn khi c√≥ d·ªØ li·ªáu.</p>
      </div>
    {% endif %}
  </div>

  <!-- SIDEBAR: TIN XU H∆Ø·ªöNG -->
  <aside class="trend-box">
    <h3 class="trend-title">Tin xu h∆∞·ªõng</h3>
    <ul class="trend-list">
      {% for item in trending %}
      <li class="trend-item">
        <div class="rank">{{ forloop.counter }}</div>
        <div class="thumb">
          <img src="{{ item.image_url|default:'https://picsum.photos/120/90?grayscale&blur=1' }}"
               alt=""
               referrerpolicy="no-referrer"
               onerror="this.onerror=null;this.src='https://picsum.photos/120/90?grayscale&blur=1';">
        </div>
        <div class="info">
          <a href="{{ item.url }}">{{ item.title }}</a>
          <div class="meta">{{ item.views }} l∆∞·ª£t xem</div>
        </div>
      </li>
      {% empty %}
      <li class="trend-item">
        <div class="rank">‚Äì</div>
        <div class="thumb"><img src="https://picsum.photos/120/90?grayscale&blur=1" alt=""></div>
        <div class="info"><span>Ch∆∞a c√≥ d·ªØ li·ªáu xu h∆∞·ªõng</span><div class="meta">S·∫Ω hi·ªÉn th·ªã khi c√≥ d·ªØ li·ªáu</div></div>
      </li>
      {% endfor %}
    </ul>
  </aside>
</section>

{# ===== DANH S√ÅCH B√ÄI M·ªöI ===== #}
<h2 class="section-title">Tin t·ª©c m·ªõi nh·∫•t</h2>

{% if q %}
  <p class="muted">K·∫øt qu·∫£ cho: ‚Äú{{ q }}‚Äù ‚Äî {{ page_obj.paginator.count }} b√†i</p>
  <div class="hr"></div>
{% endif %}

{% if object_list %}
  <section class="grid cards">
    {% for a in object_list %}
      <article class="card">
        <a class="cover" href="{% url 'article_detail' slug=a.slug %}">
          {% if a.main_image_url %}
            <img src="{{ a.main_image_url }}"
                 alt="{{ a.title }}"
                 loading="lazy"
                 referrerpolicy="no-referrer"
                 onerror="this.onerror=null;this.src='https://picsum.photos/800/400?random={{ a.id }}';">
          {% else %}
            <img src="https://picsum.photos/800/400?random={{ a.id }}"
                 alt="{{ a.title }}"
                 loading="lazy">
          {% endif %}
        </a>
        <div class="body">
          <a class="title" href="{% url 'article_detail' slug=a.slug %}">{{ a.title }}</a>
          {% if a.excerpt %}<p class="excerpt">{{ a.excerpt }}</p>{% endif %}
          <p class="meta">
            {% if a.published_at %}{{ a.published_at|date:"H:i d/m/Y" }}{% endif %}
            {% with cats=a.categories.all %}{% if cats|length %} ‚Ä¢
              {% for c in cats %}
                <a class="muted" href="{% url 'category' slug=c.slug %}">{{ c.name }}</a>{% if not forloop.last %}, {% endif %}
              {% endfor %}
            {% endif %}{% endwith %}
          </p>
        </div>
      </article>
    {% endfor %}
  </section>


{% else %}
  <div class="card" style="padding:18px">
    <b>Kh√¥ng c√≥ b√†i vi·∫øt.</b>
    <p class="muted">Kh√¥ng c√≥ b√†i ƒëƒÉng n√†o !!!!</p>
  </div>
{% endif %}

{% endblock %}
